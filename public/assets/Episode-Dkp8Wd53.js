import{j as e,u as v,r as c,b as N}from"./index-CO1LhOMl.js";import{L as b}from"./Layout-B1EvdRiN.js";import{B as E}from"./BackBtn-w3Jl13pc.js";import{a as S}from"./Episodes-cT83Rxiw.js";const P=({episode:o,nonce:r,setIframe:n})=>{async function d(s){const p=await(await fetch(`https://web-anime-psi.vercel.app/getIframe?nonce=${r}&content=${s}`)).json(),x=new DOMParser().parseFromString(p,"text/html").querySelector("iframe").getAttribute("src");n(x)}return e.jsxs("select",{onChange:s=>d(s.target.value),className:"md:w-1/4 text-sm font-semibold text-second bg-third rounded-md px-4 py-2 h-max outline-none",children:[o.mirror.m360p.map((s,a)=>e.jsxs("option",{value:s.content,className:"opt",children:[s.nama," 360P"]},a)),o.mirror.m480p.map((s,a)=>e.jsxs("option",{value:s.content,className:"opt",children:[s.nama," 480p"]},a)),o.mirror.m720p.map((s,a)=>e.jsxs("option",{value:s.content,className:"opt",children:[s.nama," 720p"]},a))]})},I=()=>{const{slug:o,name:r}=v(),[n,d]=c.useState(),[s,a]=c.useState(),[p,x]=c.useState(),[h,f]=c.useState([]);console.log(h);const u=["d360pmp4","d480pmp4","d720pmp4","d1080pmp4","d480pmkv","d720pmkv","d1080pmkv"],j=async()=>{try{const[t,m,l]=await Promise.all([fetch(`https://web-anime-psi.vercel.app/episode/${o}`),fetch(`https://web-anime-psi.vercel.app/anime/${r}`),fetch("https://web-anime-psi.vercel.app/nonce")]);if(!t.ok||!m.ok||!l.ok)throw new Error("Failed to fetch data");const[i,g,w]=await Promise.all([t.json(),m.json(),l.json()]);d(i),a(i.iframe),f(g.episodes),x(w)}catch(t){console.error("Error fetching data:",t)}};return c.useEffect(()=>{j()},[o,r]),n?e.jsxs(b,{children:[e.jsx(E,{}),e.jsxs("div",{className:"flex flex-col gap-5 mb-10",children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-5 justify-between",children:[e.jsx(P,{episode:n,nonce:p,setIframe:a}),e.jsx("h1",{className:"h1 w-2/3",children:n.judul})]}),e.jsx("iframe",{allowFullScreen:!0,src:s,className:"episode-frame"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h1",{className:"h1 text-lg",children:"Episodes"}),e.jsx(S,{anime:h,slug:o,name:r})]})]}),e.jsx("div",{className:"flex flex-col md:w-2/3 gap-3",children:u.map((t,m)=>n.download[t].length>0&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("p",{className:"text-third bg-second rounded-full px-4 py-1 w-max font-semibold text-sm md:text-lg",children:[`${t.split("p")[0].replace("d"," ")}P `,e.jsx("span",{className:"text-[10px]",children:t.includes("mp4")?"MP4":"MKV"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:n.download[t].map((l,i)=>e.jsxs("a",{href:l.href,className:"flex items-center justify-between border hover:bg-third transition-all duration-300 hover:border-third border-second w-full gap-3 rounded-lg md:py-3 p-2 md:px-4",children:[e.jsx("p",{className:"text-xs md:text-sm text-second font-semibold",children:l.nama}),e.jsx("img",{src:"/download.svg",alt:"",className:"w-3 h-3 md:w-5 md:h-5"})]},i))})]},m))})]}):e.jsx(N,{})};export{I as default};
